# mAccount
## Overview

These APIs do not perform any financial transactions. They are used manage mAccount information used by the Platform. The /financial/v1/transaction API verifies mAccount information using this subsystem before performing the transaction.


The mAccount/v1/ API support’s the following services:


  - mAccount/v1/charities
  - mAccount/v1/close
  - mAccount/v1/create
  - mAccount/v1/financials
  - mAccount/v1/get
  - mAccount/v1/listAsIssuer
  - mAccount/v1/sendStatement
  - mAccount/v1/transactions


## Objects

### mAccountActivatePasswordReset
> Schema for this object


```json
{
  "encryptedCreds": string
}
```

This supplies the encrypted Base64 data that is encoded in the email generated by mAccountPasswordResetRequest.

Field Name|Type| Description
----|---|-------
encryptedCreds | string | The encrypted credentials passed to the landing page that should be used to activate the password. Note that these credentials will expire after 2 days.

### mAccountCharityItem
> Schema for this object


```json
{
  "mAccountNumber": string,
  "name":           string
}
```

An mAccountCharityItem represents an mAccountNumber and the name of each charity that you may make a donation too. Returned by the API mAccount/v1/charities call.

Field Name|Type| Description
----|---|-------
mAccountNumber | string | This is the 16-Digit mAccount number representing the charity
name | string | This is the formal name of the charity

### mAccountDetails
> Schema for this object


```json
{
  "accountNumber":    string,  // This field is ignored in create
  "allowDuplicates":  boolean, // This field is only used in create
  "name":             string,
  "abn":              string,
  "contactName":      string,
  "contactNumber":    string,
  "email":            string,
  "addressLine1":     string,
  "addressLine2":     string,
  "suburb":           string,
  "state":            string,
  "postCode":         string,
  "bsb":              string,
  "bankAccountNumber: string,
  "bankAccountTitle": string,
  "financials":       mAccountFinancials,
  "options":          [
                        mAccountOptionItem
                      ]
}
```

Provides mAccount detail information.

Field Name|Type|Max Size| Description
----|---|----|---
accountNumber | string | 16 | 16-Digit account number that uniquely identifies the mAccount. This field is ignored in create. Required (in update).
*name | string | 50 | Company name of the mAccount. 
allowDuplicates | boolean | | If true, allow the creation of a new mAccount even though an existing mAccount with the same ABN exists.
*abn | string | 15 | Company ABN of the mAccount. All non numbers are stripped. See allowDuplicates
*contactName | string | 30 | Contact name. Spaces are stripped. 
*contactNumber | string | 15 | Contact number. All non numbers are striped.
*email | string | 300 | Contact email. Converted to lowercase.
addressLine1 | string | 40 | An optional postal address line such as a Building, section or unit 
*addressLine2 | string | 40 | An address line is the main postal address of the Company.
*suburb |string | 30 | Postal address suburb.  
*state | string | 10 | Postal address state. 
postCode | string | 10 | Postal address post code. 
bsb |string | 7| BSB number of associated bank account. BSB format is ‘000-000’.
bankAccountNumber |string | 9 |Bank account number of associated bank account. 
bankAccountTitle | string | 32 | Bank account title or name of associated bank account. 
financials | mAccountFinancials |  | See mAccountFinancials class <br> This property is ignored when calling mAccount/v1/create and mAccount/v1/upate. <br> This property only contains valid values when calling mAccount/v1/get
options |[mAccountOptionItem]|  |  See mAccountOptionItem class
*Required Field

### mAccountFinancials
> Schema for this object


```json
{
  "actualBalance": number
}
```

When returned, contains the mAccounts current financial values.


**Note **


The returned field actualBalance is the current balance in the Platform. During a settlement run, fees and charges may be applied.  The Platform has several sub-systems that keep their own transactions separate until the transactions are authorised. During settlement these authorised transactions are moved into the Platform as a single transaction amount.


If the mAccount is only transacting through the financial/v1 APIs, then the actualBalance returned will be accurate except for any settlement fees or charges that may be applied.


Field Name|Type| Description
----|---|------
actualBalance | number | Balance of the mAccount


### mAccountOptionItem
> Schema for this object


```json
{
  "key":    string,
  "value":  string
}

```

An mAccountOptionItem represents a key/value pair of configuration options that apply to a particular mAccount.


**Note **


 - If value is an empty string, the option represented by the key is set to its default value.
 - If the key is omitted from the array, the option represented by the key is left as is.
 - An invalid key or value will result in an error.
 - key is case insensitive


Field Name|Type| Description
----|---|------
key | string | Unique identifier of the value. See Key Definitions table below
value | string | The actual value represented by the Key

**Key Definitions**

Key | Range | Description
-----|------|------------
DebitTplusXDays |“0” -> “5” | days Number of days between lodgement and settlement of debits
CreditTplusXDays | “0” -> “30” | days  Number of days between lodgement and settlement of credits
SettlementFrequency ||“None” No Settlement <br>“Daily” Every Business Day - EOD <br>“BeginningOfMonth”  First Business Day of Month - EOD <br>“EndOfMonth”  Last Business Day of Month - EOD <br>“MidMonth”  First Business Day on or after the 15th of month - EOD <br>“OnDemand”  Only when manually initiated by Moneytech Payments <br>“OnDemandWithCatch” Manually initiated and also Every Bsiness Day - EOD <br>“OncePerDay”  Will not run at EOD if a manual settlement prior for same day
MobileForSms | “0414111111” | The mobile number to use when sending an SMS to the mAccount
MinimumSettlementAmount |“0.02” -> “100.00” | The mAccounts minimum balance to trigger a EOD settlement. 
SendSettlementStatement |“true” or “false” | Set to “true” if you would like a settlement statement automatically sent to the Email address of the mAccount. If no settlement occurred, no statement is sent.
SendDailyStatement | “true” or “false” | Set to “true” if you would like a daily statement automatically sent to the Email address of the mAccount. If the mAccount has no transactions for the period, no statement is sent.
SendMonthlyStatement | “true” or “false” | Set to “true” if you would like a Monthly statement automatically sent to the Email address of the mAccount. Sent on the 1st of each month for the previous month. If the mAccount has no transactions for the period, no statement is sent.


### mAccountPasswordResetRequest
> Schema for this object


```json
{
  "accountNumber":        string,
  "resetUrlLandingPage":  string
}
```

Supplies the account number whose password is to be reset and landing page that the generated email uses to activate the new password.


Field Name|Type| Description
----|---|------
*accountNumber | string | 16 |  16-Digit account number that uniquely identifies the mAccount. 
resetUrlLandingPage |string | 500 | "The email generated contains a hyperlink that refers to this page that allows the user to activate the auto-generated password.
This URL will have a query param auth appended for use in activation. 
If this parameter is empty then the default page used is the default mAccount activation web page."
*Required Field


### mAccountSelectionFilter
> Schema for this object


```json
{
  "accountNumber":  string,
  "frequency":      string,
  "startDate":      string,
  "endDate":        string
}
```

Supplies the account number whose password is to be reset and landing page that the generated email uses to activate the new password.


Field Name|Type| Max Size | Description
----|---|----|--
*accountNumber | string | 16 | 16-Digit account number that uniquely identifies the mAccount.
*frequency | string | |  An enumeration of fixed selection types. <br> All, <br>Today, <br>Yesterday, <br>ThisWeek, <br>LastWeek, <br>ThisMonth, <br>LastMonth, <br>LastFinancialQuarter, <br>ThisFinancialQuarter, <br>ThisFinancialYear, <br>LastFinancialYear, <br>LastDailySettlement, <br>Custom
startDate | string |  | Start date of statement when the frequency is set to Custom in ISO 8601 date format. Note that Timezone is suppressed. The default Timezone is Sydney local time. Required field when frequency is set to custom.
endDate | string | |  End date of statement when the frequency is set to Custom in ISO 8601 date format. Note that Timezone is suppressed. The default Timezone is Sydney local time. Required field when frequency is set to custom.
*Required Field

### mAccountTransactionRequestDetails
> Schema for this object


```json
{
  "accountNumber":  string,
  "startDate":      string,
  "endDate":        string,
  "skip":           number,
  "take":           number,
  "descending":     boolean,
  "useTime":        boolean
}
```

Supplies the account number whose password is to be reset and landing page that the generated email uses to activate the new password.


Field Name|Type| Max Size | Description
----|---|----|--
*accountNumber|  string | 16 | 16-Digit account number that uniquely identifies the mAccount.
startDate| string | |  Start date of transaction range to retrieve. In ISO 8601 date format. Note that Timezone is suppressed. The default Timezone is Sydney local time. If not set to a valid date then the 1 Jan 2013 is used. The Time component is ignored unless useTime is set to true.
endDate| string | |  End date of transaction range to retrieve. In ISO 8601 date format. Note that Timezone is suppressed. The default Timezone is Sydney local time.  If not set the todays date is used. The Time component is ignored unless useTime is set to true.
skip|  number | |  Number of records to skip. 0 is the first record.
take|  number | |  Number of records to take. If take is 0 then all records will be returned.
descending|  boolean | | Sort the returned transaction list in ascending or descending.
useTime| boolean | | Use the time component of startDate and endDate in the selection.
*Required Field

### mAccountTransactionLineItem
> Schema for this object


```json
{
  "transactionId":          number,
  "rowOrder":               number,
  "dateTime":               string,
  "description":            string,
  "transactionDescription": string,
  "debit":                  number,
  "credit":                 number,
  "runningBalance":         number,
  "mWalletAccountNumber":   string,
  "transactionType":        string,
  "subTransactionType":     string,
  "mPaymentsId":            number
}
```

Represents a single line item or row on an mAccount statement.  See mAccount/v1/transactions


Field Name|Type | Description
----|---|------
*transactionId |  number | This is the transactionId that was returned from a financial transaction
*dateTime | string | The time the transaction occurred in ISO 8601 date format. Note that Timezone is suppressed. The default Timezone is Sydney local time. 
*description |  string | This is the description that was provided by the caller to the financial API with your unique reference prepended.
*transactionDescription | string | A small description describing the financial action
*debit |  number | The amount of funds debited from the mAccount
*credit | number | The amount of funds credited from the mAccount
*runningBalance | number | The current balance of the mAccount at the end of this single row transaction
rowOrder |  number | If you need to sort the results, only use this field. If you sort the results on any other field, the runningBalance won’t make sense. rowOrder start at 0.
mWalletAccountNumber |  string | If funds were being moved to/from an mWallet, then this is the mWallets 16-Digit account number
transactionType | string | Major keyword describing the transaction. E.g. include Payment, LoadFunds,  DailySettlement
subTransactionType |  string | Minor keyword describing the transaction. E.g. GatewayMWalletCredit
mPaymentsId | number | This is the Platform internal Id for the row returned. 
*Required Field



## Charities

> The above command returns JSON structured like this:

```json
{
	"items":              [
                          mAccountCharityItem
  						          ],
	"status": 			      string,
	"statusDescription":  string,
	"durationMs": 		    number,
}
```

This API returns a list of charities that you are authorised to make donations too. The list includes both public and private charities you have asked Moneytech Payments to configure.

### HTTP Request

`GET http://example.com/mAccount/v1/charities`

### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
items|[mAccountCharityItem]|An array of mAccountCharityIte’s. Each available charity will have an entry in this array. See the mAccountCharityItem section
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the section Status & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## Close

> The above command returns JSON structured like this:

```json
{
  "status":                string,
  "statusDescription":     string,
  "durationMs":            number
}
```

This API closes an mAccount. 

### HTTP Request

`GET http://example.com/mAccount/v1/close/{accountNumber}`

### Field Descriptions

Field Name  | Description
--------- | -------
accountNumber | 16-Digit number representing the required mAccount

### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## Create

> The above command returns JSON structured like this:

```json
{
  "accountNumber":         string,
  "status":                string,
  "statusDescription":     string,
  "durationMs":            number
}
```

This API creates an mAccount.

### HTTP Request

`POST http://example.com/mAccount/v1/close/{accountNumber}`

### Request Body Schema

```json
{
	"accountNumber": 	string,  // This field is ignored in create
	"allowDuplicates":  boolean, // This field is only used for create
	"name": 			string,
	"abn": 				string,
	"contactName": 		string,
	"contactNumber": 	string,
	"email": 			string,
	"addressLine1": 	string,
	"addressLine2": 	string,
	"suburb": 			string,
	"state": 			string,
	"postCode": 		string,
	"bsb": 				string,
	"bankAccountNumber: string,
	"bankAccountTitle:  string,
	"financials":       mAccountFinancials, // This field is ignored in create
	"options":          [
					      mAccountOptionItem
				        ]
}
```

### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
accountNumber| string|New 16-Digit mAccount account number
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## Financials

> The above command returns JSON structured like this:

```json
{
  "financials":         mAccountFinancials,
  "status":                string,
  "statusDescription":     string,
  "durationMs":            number
}
```

This API will return the current financials for an mAccount.

### HTTP Request

`GET http://example.com/mAccount/v1/financials/{accountNumber}`

### Request Body Schema

Field Name | Description
---- | ----
accountNumber|16-Digit number representing the required mAccount

### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
financials| mAccountFinancials|See mAccountFinancials class
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## Get

> The above command returns JSON structured like this:

```json
{
  "financials":           mAccountDetails,
  "status":               string,
  "statusDescription":    string,
  "durationMs":           number
}
```

This API gets details of an mAccount.


Property details.options will contain ALL options and their current values.

### HTTP Request

`GET http://example.com/mAccount/v1/get/{accountNumber}`

### Request Body Schema

Field Name | Description
---- | ----
accountNumber|16-Digit number representing the required mAccount

### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
details|mAccountDetails|See mAccountDetails class
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## ListAsIssuer

> The above command returns JSON structured like this:

```json
{
  "mAccounts":            [
                            string
  						            ],
  "status":               string,
  "statusDescription":    string,
  "durationMs":           number
}
```

Returns a list of 16-Digit mAccounts that you own. These mAccounts can be used by the security/v1/createImpersonationTokenAsIssuer API. 

### HTTP Request

`GET http://example.com/mAccount/v1/listAsIssuer`


### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
mAccounts|[string]|Array of 16-Digit account numbers
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.



## Send Statement

> The above command returns JSON structured like this:

```json
{
  "status":               string,
  "statusDescription":    string,
  "durationMs":           number
}
```

This API generates a detailed pdf statement for delivery via email. 


### HTTP Request

`POST http://example.com/mAccount/v1/sendStatement`

### Request Body Schema

```json
{
	"accountNumber": string,
	"frequency":     string,
	"startDate":     string,
	"endDate":       string
}
```

Field Name | Description
---- | ----
accountNumber|16-Digit number representing the required mAccount

### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## Transactions

> The above command returns JSON structured like this:

```json
{
  "status":               string,
  "statusDescription":    string,
  "durationMs":           number
}
```

This API generates a detailed pdf statement for delivery via email. 


### HTTP Request

`POST http://example.com/mAccount/v1/transactions`

### Request Body Schema

```json
{
	"accountNumber": 	string,
	"startDate": 		string,
	"endDate": 			string,
	"skip": 			number,
	"take": 			number,
	"descending": 		boolean,
	"useTime": 			boolean
}
```


### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
openingBalance |	Number|	Opening balance of the mAccount for the returned items
closingBalance |	Number|	Closing balance of the mAccount for the returned items
totalDebits |	Number|	Total debits for the returned items
totalCredits |	Number|	Total credits for the returned items
items |	[mAccountTransactionLineItem]	| See mAccountTransactionLineItem
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.



## Update

> The above command returns JSON structured like this:

```json
{
  "status":               string,
  "statusDescription":    string,
  "durationMs":           number
}
```

This API will return an array of transactions for an mAccount between two dates. Paging is supported by using the skip and take properties of the mAccountTransactionRequestDetails class.


The information retrieved is in real-time and represents the same details as displayed on an mAccounts financial statement.


### HTTP Request

`POST http://example.com/mAccount/v1/update`

### Request Body Schema

```json
{
  "accountNumber": 		string, 
  "name": 				string,
  "abn": 				string,
  "contactName": 		string,
  "contactNumber": 		string,
  "email": 				string,
  "addressLine1": 		string,
  "addressLine2": 		string,
  "suburb": 			string,
  "state": 				string,
  "postCode": 			string,
  "bsb": 				string,
  "bankAccountNumber":  string,
  "bankAccountTitle":   string,
  "financials": 		mAccountFinancials, 	// This field is ignored in update
  "options": 			[
							       mAccountOptionItem
  						    ]
}
```


### Response Field Descriptions ###

Field Name | Type | Description
--------- | ------- | -----------
status | string | This is the status of executing the request. A code of ‘Ok’ indicates no errors. See the sectionStatus & Descriptions
statusDescription | string | This is a plain English description of the status. See the sectionStatus Description.
durationMs | number | This can be ignored. This value represents the total time in milliseconds that thePlatform took to process the request.


## Status and Descriptions

Status Code | Description|HTTP Status
----|----|---
Ok |	Call has succeeded.	|200
Unauthorized |	Authentication Failure	|401
Error |	Exception has occurred.	|400
MerchantTokenNotFound |	The Merchants token was not found.	|400
MerchantNotValidToTransact |	Merchants not valid to transact.	|400
InvalidToken |	A parameter passed as part of the call is formatted incorrectly. The Merchant does not exist. statusDescription provides a detailed reason for the failure.	|400
MerchantTokenFound	|Trying to change a Merchant incorrectly or create a new mAccount that already exists.	|400
MerchanttIsOnHold|	The Merchant has been placed On-Hold	|400
MerchantIsClosed|	The Merchant has been closed	|400
AccountIsCharityNoFinancialsAllowed|You may not retrieve financial information for a Charity	|400
AccountIsCharityNoUpdateAllowed|You may not update any information on a Charity	|400
AccountIsCharityNoGetAllowed|You may not get any information on a Charity	|400
AccountIsCharityNoCloseAllowed|You may not close a Charity	|400
AccountIsCharityNoRetrieveTransactionsAllowed|You may not retrieve any financial transaction for a Charity	|400
AccountIsCharityUnableToSendStatement|You may not send a statement to a Charity	|400